---
description: '-'
---

# \[우아한테크세미나] 배민송년회 퀴즈 서비스, 한 달 안에 만들기 | 23년 1월

#### 배민다운 송년회 히스토리 그리고 <히든배민> 탄생기

* 배민의 조직 문화를 가꿔가는 조직&#x20;
* 긍정적인 배민 문화를 경험할 수 있도록 함&#x20;
* 2번의 전사행사
  * 6월 서비스런칭기념일(N주년)
  * 12월 송년회
    * 드레스코드도 있음&#x20;
  * 우아한 인재상&#x20;



* 우형의 전사행사란?
  * 배민다운 소통의 경험이 꽃을 피우는 장&#x20;
  * 매번 다르게 새로운 경험으로 주고자 합니다&#x20;
    * 밥상예술대상 -> 1500명 정도 구성원들이 화상으로 얼굴을 보면서 했음&#x20;
    * 마치 하나의 예능처럼 보게 만드는 경우&#x20;
      * 배민에브리원
  * 팀빌딩 컨텐츠 위주로 구성을 했음&#x20;
  * 우아한 사이드프로젝트 사이트

### 히든배민 개발기

* SCM플랫폼팀 이찬호님
* 운영도구개발팀 장해민님

#### 개발기&#x20;

* 요구사항 분석 / 설계
* 기술선정 / 개발&#x20;
* 디자인&#x20;
* 테스트



* 프론트 2분이셨음&#x20;
* 정말로 빼면 안 되는 기능만 추림&#x20;
  * 가장 최소한의 MVP를 뽑아서 설계를 함&#x20;
* kahoot을 레퍼런스로 해서 구현&#x20;
* 행사장이 어떤 모습일까 상상을 해보심&#x20;
* 실제 사용하는 환경을 생각하며 설계, 분석을 함&#x20;

1. 무대 스크린&#x20;

* 우리가 만든 페이지가 들어가야 하는 게 아님

2\. 프롬프터&#x20;

* MC 분들이 보는 화면 => 현재 문제가 몇 번이고, 카운트 다운, 접속자 수가 나오는 화면이 필요하겠구나&#x20;

3\. 플레이어 -> 답안지 확인 화면&#x20;

4\. 콘솔 -> 퀴즈들을 관리해야 하는 영역이 필요하겟다고 생각&#x20;



* 각 상태들이 있는데, 핸드폰에서는 어떤 화면이 나와야 하고, 컨트롤하는 우리들은 어떤 동작을 상태마다 할 수 있는지 표로 정리를 함&#x20;
* 시뮬레이션을 통해 정리하고 개발함&#x20;



* 문제가 최대한 안 생기는 방향으로 만들어서 개발을 시작하게 됨&#x20;
* 기획을 구성하고 나서...
* 아 여기서는 어떻게 만들까?



#### 기술선정 / 개발&#x20;

* AWS Lightsail
* Redis
* WebSocket
* Next.js
* 이 모든 것들은 기존 경험과 알고 있는 것들을 기준으로 생각&#x20;



* 바닥부터 조사를 하는 식으로 한 거는 아님&#x20;
* 심플함에 집중&#x20;



* Typescript => 우아한 프론트엔드 표준&#x20;
* 백엔드 모두 이것으로 했음&#x20;
* 이런 류의 트래픽을 받아본 경험이 없었기 때문&#x20;



* 최소한의 인원으로 하기 때문에 인프라, 백엔드 개발자를 따로 하지 않음&#x20;

#### 1. AWS lightsail

* 인프라 기술 스택&#x20;
* AWS의 유일하게 써보셨다고 하심&#x20;
* 고정된 크기의 하드웨어 리소스 패키지&#x20;
* 인스턴스 사용한 시간만큼만 비용 청구&#x20;



#### 2. Redis

* in-memory 데이터 저장소&#x20;
  * RAM에 데이터를 저장한다는 것&#x20;
  * 데이터베이스로 사용할 수도 있다는 것&#x20;
* 빠른 read/write&#x20;
* 일회성 퀴즈 서비스에 적합&#x20;
* 메인 DB로 우리는 사용했어요!
* 쓰고 읽는 속도가 굉장히 빠름&#x20;
* RAM은 비싸고 용량이 적어...
* 많은 데이터를 저장할 때는 캐쉬용이라&#x20;



* 일회성 퀴즈라서 빠른 RAM에 데이터를 저장하는 것을 선택하심&#x20;
* 구성원 정보와 게임 정보만 저장하기에도 매우 충분했음&#x20;



* WebSocket을 하기 위해서는 정말 빠른 저장소에 저장하고 싶었음&#x20;

#### WebSocket.io&#x20;

* socket.io : 구현체
* MEC, BroadCast
* 서버와의 싱크가 매우 중요&#x20;
* 소켓 클라이언트에게 전파하는 프로토콜이 필요했음&#x20;
* HTTP Polling, Long Polling도 가능했지만, 이게 더 적합했음&#x20;



* 자동으로 Long Polling 형태로 fallback이 되어 많은 고객들을 구성&#x20;
* 백엔드, 인프라, 통신 프로토콜을 준비 ====>

#### Next.js&#x20;

* 실제 화면을 만듬&#x20;
* 애플리케이션&#x20;
* React Framework&#x20;
* 우형 기술 표준&#x20;
  * React도 표준임&#x20;
  * typescript, React로 Next.js 프레임워크를 사용함&#x20;
* SSR을 기준으로 말을 하지만&#x20;
* Next.js는&#x20;
  * 구조적 제한을 주고&#x20;
  * API 라우트라는 독특한 기능이 탑재&#x20;



* 한 달안에 별다른 논쟁없이 했어야 했기 때문에&#x20;
  * 구조적 제한을 주기 위한 선택&#x20;
  * 페이지 디렉토리 구조&#x20;
  * API 라우터 구조&#x20;
  * 코드 짜야하는 방식이 정해져있기 때문에&#x20;
* 별도의 백엔드 없이&#x20;
  * API 라우터 때문에 동시에 제공함&#x20;



#### 디자인&#x20;

* asset은 다 받고, UI/UX는 우리가 디자인했어요
* assets은 직접 구성해보거나 공부해 볼 필요가 있는듯&#x20;
  * 개인적인 생각&#x20;
* 새로운 경험을 주고 싶었습니다&#x20;
* Chroma Key
  * 타협을 할 수 없었음&#x20;
* 새로운 경험이 아니라 이게 뭐야 할 수 있기 때문에&#x20;
* 무대에 입장하고 싶은 느낌을 주고 싶었음&#x20;
* 영상으로 하면 가장 리얼할 거 같았음&#x20;
* 낭만을 포기할 수 없어서...



* iOS 저전력 모드에서 동영상 자동 재생 안되는 이슈&#x20;
* 전혀 알 수 없었음&#x20;
* 그 누구도 동영상을 빼고자 하지 않음&#x20;
* 저전력에서는 디자인의 아름다움을 뺄 수 없음&#x20;
  * 저전력 모드에 따라 따로 구현하심&#x20;
* 이미지를 그냥 갔다 넣기만 하면 가만히 기다리는 거 같아&#x20;



* 참을 수 없음&#x20;
  * 낭만 개발자!



* transition을 주어서 반짝반짝하는 효과&#x20;
  * 생기를 불어넣는 작업&#x20;



* MVP를 만들고 서비스 나가기 전에 QA를 하게 됨&#x20;



#### WebSocket 시뮬레이션 & 테스트

* 연결이 안 되면 할 수 없는 상태&#x20;
* 가상의 클라이언트를 500개 해보니&#x20;
  * 최대 500개의 WebSocket 연결&#x20;
  * ?????
* 개발하다가 식은땀이 남&#x20;
* 안일 햇음&#x20;
* 구현체의 홈페이지를 방문해서 방법을 찾음&#x20;
* 뭐,,, nodejs로 100만개의 도달했다고 함&#x20;



* 프로세스가 가질 수 잇는 파일 개수가 있음&#x20;
  * 소켓도 포함인것&#x20;
  * default 값이 1024
  * 1024개의 소켓만 한 번에 열 수 있다는 것
* Linux Open Files
  * 대부분의 리소스를 리눅스에서는 파일로 취급&#x20;
  * OS Version 마다 값을 취급하는 방법이 달라짐&#x20;
* 동욱님의 Open file Link
  * [https://jojoldu.tistory.com/287](https://jojoldu.tistory.com/287)
  * [https://techblog.woowahan.com/2569/](https://techblog.woowahan.com/2569/)
* 대규모 접속 대응 시 저 옵션은 필수겟음&#x20;





Nginx (reverse Proxy)

* proxy\_set\_header => Upgrade, Connection 설정이 필요&#x20;
* nginx 공식 문서에 나와있음&#x20;



* 테스트 프로그램은 socket.io 예시를 참고함&#x20;
* 클라이언트를 for문으로 돌면서 생성함&#x20;
* 예외처리는&#x20;
  * 연결이 유지가 안 되고 끊기는 부분&#x20;
  * 자동으로 끊기는 순간 강제로 재연결되는 옵션을 socket.io에서 확인하심&#x20;
* API 호출에서 에러 발생 시&#x20;
  * 한 번더 호출하겠음&#x20;
  * 성공할테까지&#x20;
  * 절대 벗어날 수 없게 함&#x20;



* 전 날까지도 테스트하고, 테스트하고..
  * 점수 집계 잘 되는지 다시 보고\~
* 웹 페이지 로드하는데도 엄청난  트래픽&#x20;
  * 동영상 ,이미지를 5분의 1로 줄였음&#x20;
    * 웹 사이트 자체 크기를 줄이는 것&#x20;



* 리허설 날 UI 리사이징 같은 게 너무 작음&#x20;

#### 이슈는 배포날에 터진다

* 실제로 동시 접속 이슈가 있었어
* 웹 소켓은 문제없었는데
  * 가상에서는 문제가 아닌데
* 5000명이 리소스를 받아오는 친구들이 아니었음&#x20;
  * 아하
* 2000명이 동시접속
  * 작고 소중한 서버에서 동시에 내려주니...
  * 줄였던 이미지 사이즈 조차도 너무 컸음&#x20;
* 300명 정도는 잘 되는데.....
  * 컨트롤 타워가 들림&#x20;
  * 어?
* 저희 서버가 다행이 죽지는 않음&#x20;
  * 시간이 조금 오래걸렸음&#x20;
* 서버가 계속 리소스를 내려주어야 했기 때문&#x20;



* 콘솔쪽에서 컨트롤 타워로 관리할 때&#x20;
* 개인별 점수가 안나와
  * 서버에서 문제가 생김&#x20;



* 알고리즘 넣을 때&#x20;
  * 당연히 이름이 있겠다 생각을 했었음&#x20;
  * 이름이 없는 사용자가 있어?
* a. name.localCompare
  * a.name이 undefined?
* 공개형 프로필 이름이 없을 수도 없음&#x20;
* 어떤 경우든지 이름이 없는 사람이 입장
* 분리가 되어있던 API
  * 너무 다행히, 빼버리고 바로 그룹 조직 평균 점수만 가자\~



* 와.. 실제로 해보자

#### 개발과 기획 모두 잘 할 방법이 있을까?

* 제대로 배워서 하는 것도 아니고, 기획해보는 것들이라&#x20;
* 대답드리기 어려움&#x20;
* 기획을 하려면, 기회가 있어야 함&#x20;
* 회사에서 기회가 있거나, 사이드, 토이 프로젝트로 할 수 있을 것&#x20;



* 실제로 주 업무에서 기획과 개발을 할 수는 없음&#x20;
* 개발자들끼리만 서비스했던 경험이 있음&#x20;



* 논의는 되게 잘하는 데, 어떤 것들을 만들어야 할 지 정리가 안 되어있다면?
  * 뭐 하기로 했죠?가 됨&#x20;
* 문서와 요구사항을 최소화하는 것이 제일 중요&#x20;



* 기획은 문서가 중요하고 여러사람이 읽었을 때 동일한 그림을 그릴 수 있느냐 확인&#x20;

\---

*   20000명의 트래픽이 예상되었다면?



    * 백엔드와 인프라 개발자를 구햇을 듯?



*   본업을 하면서 사이드 프로젝트를 함께 진행할 수 있었던 원동력!

    * 그냥 즐거운 일
    * 즐거운 작업, 좋아하는 작업, 잘하는 작업을 하면서 즐거웠습니다&#x20;
    * 일정, 체력 관리에 부담을 느끼지는 않았어요
    * 좋은 리액션!



#### 배민송년회 퀴즈 서비스의 아이디어?

* 인터넷, 컨텐츠, 재밌는 아이디어?
* 잡담을 많이 하면 할 수록 경쟁력이다?
  * 우와\~
  * 요즘 뭐하고 지냈는지, 얘기하고 시작할까요?
  * 평소에도 잡담을 하면서 나오는 아이디어들이 있음&#x20;



#### 촉박한 시간 내의 일정 관리?

* 우선순위를 정하며 진행했는가?
* 아이디어가 많았다가...
* 절대로 빼면 안 되는 핵심 기능들은 무엇이냐
* 이것은 무조건 가져야 하는 기능이다만 넣고&#x20;
  * 남는 시간에 추가를 하는 것&#x20;
* 한 바퀴가 돌아갈 수 있는&#x20;
  * 조금씩 늘리는 방법&#x20;
  * 어쨌든 한 바퀴 돌아갈 정도는 되니까





* 실제로 사람들을 받을 수 있는 서비스를 만드는 것을 추천함&#x20;
*



\---



#### 우아한 사이드 프로젝트 ??&#x20;





































































